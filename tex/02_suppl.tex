\documentclass[11pt, class=article, crop=false]{standalone}
\usepackage[subpreambles=true]{standalone}
\usepackage[T1]{fontenc} % for font setting
\usepackage{newtxtext, newtxmath}
\usepackage{import,
            graphicx,
            parskip,
            url,
            amsmath,
            amssymb,
            wrapfig,
            fancyhdr,
            soul,
            tabularx}

% graphic path
\graphicspath{ {./data_fmt/} }

% external document
%----Helper code for dealing with external references----
% (by cyberSingularity at http://tex.stackexchange.com/a/69832/226)

\usepackage{xr}

\newcommand*{\addFileDependency}[1]{% argument=file name and extension
\typeout{(#1)}% latexmk will find this if $recorder=0
% however, in that case, it will ignore #1 if it is a .aux or 
% .pdf file etc and it exists! If it doesn't exist, it will appear 
% in the list of dependents regardless)
%
% Write the following if you want it to appear in \listfiles 
% --- although not really necessary and latexmk doesn't use this
%
\@addtofilelist{#1}
%
% latexmk will find this message if #1 doesn't exist (yet)
\IfFileExists{#1}{}{\typeout{No file #1.}}
}\makeatother

\newcommand*{\myexternaldocument}[1]{%
\externaldocument{#1}%
\addFileDependency{#1.tex}%
\addFileDependency{#1.aux}%
}
%------------End of helper code--------------

\myexternaldocument{01_main}

% side caption figure
\usepackage{sidecap}
\sidecaptionvpos{figure}{t}

% for special characters in bibliography            
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% citation setup
\usepackage[euler]{textgreek}
\usepackage[sort&compress]{natbib}
\setcitestyle{square}
\setcitestyle{comma}
\bibliographystyle{bibstyle}

% caption setup
\usepackage[font={f, small}, labelfont={bf, small}]{caption}
           
% color box
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable}

% margin
\usepackage[top=2.54cm, bottom=2.54cm, left=2.54cm, right=2.54cm]{geometry}%set margin

\title{Supporting Information}
\date{} % remove date from title

\begin{document}

\maketitle

\tableofcontents

\newpage

\section{Supplementary Text}

\subsection{Theory}

\subsubsection{Model Derivation}

\textit{Single patch dynamics} --
Our model builds upon the deterministic approximation of the continuous-time Markov process.
Let $\pi'_{ik}(t)$ be the binary random variable ($\pi'_{ik}(t) \in \{0, 1\}$) that denotes the presence (1) / absence (0) of species $k$ at patch $i$ and time $t$.
The exact dynamics can be described by a stochastic differential equation:

\begin{equation}
    \pi'_{ik}(t + dt) - \pi'_{ik}(t) = c'_{ik}(t) (1 - \pi'_{ik}(t)) - \mu'_{ik}(t) \pi'_{ik}(t),
    \label{eq:sde0}
\end{equation}

where $c'_{ik}(t)$ and $\mu'_{ik}(t)$ are time-independent Bernoulli random variables representing colonization and extinction with means:

\begin{align}
    \begin{split}
        \overrightarrow{c'_{ik}(t)} &= c_{ik} dt,\\
        \overrightarrow{\mu'_{ik}(t)} &= \mu_{ik} dt.
    \end{split}
\end{align}

The notation $\overrightarrow{\cdot}$ denotes the average over an ensemble of stochastic realizations of the temporal Markov process at patch $i$.
We rewrite Equation \ref{eq:sde0} using the means:

\begin{equation}
    d \pi'_{ik} = [c_{ik} (1 - \pi'_{ik}(t)) - \mu_{ik} \pi'_{ik}(t)]dt + d\xi_{ik}(t),
    \label{eq:sde1}
\end{equation}

where $d\xi_{ik}(t)$ is the stochastic term given by:

\begin{equation}
    d\xi_{ik}(t) = (c'_{ik}(t) - \overrightarrow{c'_{ik}(t)}) (1 - \pi'_{ik}(t)) - (\mu'_{ik}(t) - \overrightarrow{\mu_{ik}(t)}) \pi'_{ik}(t).
\end{equation}

Here, we set $d\xi_{ik}(t) = 0$ considering the stationary state of the Markov process and focus on the deterministic component of Equation \ref{eq:sde1}, which approximates the temporal behavior of the stochastic model.
A proxy $\pi_{ik}$ ($0 \le \pi_{ik} \le 1$) is used to approximate the probability of patch $i$ being occupied ($\overrightarrow{\pi'_{ik}(t)}$), leading to the deterministic counterpart of Equation \ref{eq:sde1} expressed as:

\begin{equation}
    \frac{d \pi_{ik}}{d t} = c_{ik} (1 - \pi_{ik}) - \mu_{ik} \pi_{ik}
    \label{eq:dm0}
\end{equation}

In what follows, we use Equation \ref{eq:dm0} as the baseline model that describes the temporal evolution of occupancy probability at a single patch.

\textit{Colonization} --
We express the colonization rate $c_{ik}$ as a function of ecological and ecosystem attributes.
Specifically, we define $c_{ik}$ as follows:

\begin{equation}
    c_{ik} = r_{ik} \frac{\sum_{j \ne i}^N c_{0, jk} \pi_{jk}}{N},
    \label{eq:clnz}
\end{equation}

where $r_{ik}$ is the establishment probability related to resource supply or prey availability (see below), $c_{0, jk}$ is the number of effective propagules produced by patch $j$, and $N$ is the number of patches in the ecosystem ($N = hL$, where $h$ denotes the habitat density per unit distance) .
The term $\sum_{j \ne i}^N c_{0, jk} \pi_{jk}$ represents the total number of propagules produced in the ecosystem (i.e., summed across habitat patches) after accounting for dispersal costs and species reproductive traits.
We scaled $\sum_{j \ne i}^N c_{0, jk} \pi_{ik}$ by $N$ based on the assumption that these surviving propagules are evenly allocated across habitat patches.
For simplicity, we assume that the number of propagules produced is constant over space ($c_{0, jk} \equiv c_{0, k}$).
We also use the approximation for the proportion of patches occupied $p_k$ as $p_k = N^{-1}\sum_{j}^N \pi_{jk} \approx N^{-1}\sum_{j \ne i}^N \pi_{jk}$, assuming that $N$ is sufficiently large.
These simplifying assumptions, without loss of generality, yield:

\begin{equation}
     c_{ik} \approx r_{ik} c_{0, k} p_k
\end{equation}

The establishment probability $r_{ik}$ represents different quantities for producers and consumers:

\begin{equation}
    r_{ik} =
    \begin{cases}
    r_{0} & \text{if $k~\in~\text{producer}$,}\\
    \frac{\sum_{q~\in~\text{prey}} \pi_{iq}}{S_{p, k}} & \text{if $k~\in~\text{consumer}$,}
    \end{cases}
    \label{eq:r-eq}
\end{equation}

where $r_0$ ($0 \le r_0 \le 1$) is the resource supply, $\sum_{q~\in~\text{prey}} \pi_{iq}$ is the expected number of prey species available at patch $i$, and $S_{p, k}$ is the number of prey species consumable for consumer $k$.
This formulation assumes that resource or proportional prey availability increases species' establishment.
The resource supply $r_0$ is assumed to be constant over space.

The number of effective propagules produced by a single occupied patch $c_{0, k}$ is the product of the gross number of propagules $g_{k}$ and the survival probability during dispersal $\phi_k$.
However, we constrain $c_{0, k}$ by the number of habitat patches $N$ since $N$ is the maximum number of patches that effective propagules can colonize:

\begin{equation}
    c_{0, k} = 
    \begin{cases}
        g_k \phi_k & \text{if $g_k \phi_k < N$},\\
        N & \text{if $g_k \phi_k \ge N$}.
    \end{cases}
    \label{eq:c0-prod}
\end{equation}

The survival probability during dispersal $\phi_k$ is a function of the species-specific dispersal capability $\delta_k$ and the habitat density $h$:

\begin{equation}
    \phi_k = 1 - e^{-\delta_k h}.
    \label{eq:phi}
\end{equation}

Equation \ref{eq:phi} assumes that propagule survival during dispersal increases with increasing dispersal capability and habitat density.

\textit{Extinction} -- 
We express the extinction rate $\mu_{ik}$ as a function of disturbance, prey availability, and predation:

\begin{equation}
    \mu_{ik} = 
        \underbrace{\mu_{k}^{(0)} (1 + \rho u_i)}_{\text{Disturbance}} + 
        \underbrace{\mu_{k}^{(p)} \left(1 - \frac{\sum_{q~\in~\text{prey}} \pi_{iq}}{S_{p, k}} \right)}_{\text{Prey availability}} + 
        \underbrace{\mu_{k}^{(c)} \sum_{q~\in~\text{predator}} \pi_{iq}}_{\text{Predation}}.
    \label{eq:extn}
\end{equation}

The disturbance term is composed of two sources.
The first component is the stochastic disturbance occurring at the patch ($\mu_{k}^{(0)}$).
The second component is the influence of downstream disturbance cascade ($\mu_{k}^{(0)} \rho u_i$), where $\rho$ and $u_i$ denote the disturbance synchrony probability and the upstream river length at patch $i$, respectively.
In rivers, any disturbance can cascade downstream as water flows downstream.
For example, the impact of environmental pollutants may be spatially extensive because they are conveyed through downstream water movement.
Similarly, flood and drought disturbances are highly correlated between up- and downstream reaches, likely causing synchronized extirpation of organisms across space.
Our model assumes that such risks of synchronized disturbance linearly scale with the upstream river length $u_i$, allowing us to capture the essential feature of riverine systems.
The parameter $\rho$ independently controls the strength of up- and downstream synchronization.

In the prey term, we assume that the extinction rate decreases with increasing species richness of available prey at patch $i$.
Specifically, the parameter $\mu_{k}^{(p)}$ denotes the extinction rate in the complete absence of prey species.
The extinction risk caused by the lack of prey is reduced by the factor $S_{p, k}^{-1} \sum_{q~\in~\text{prey}} \pi_{iq}$ ($\le 1$), which is the ratio of the expected species richness of available prey relative to the number of possible prey species $S_{p, k}$.
Note that $\mu_{k}^{(p)} = 0$ for producers.

In the predation term, the extinction risk caused by predation is assumed to increase linearly with the species richness of predators at patch $i$.
The parameter $\mu_{k}^{(c)}$ defines how quickly the extinction rate increases with the expected species richness of predators $\sum_{q~\in~\text{predator}} \pi_{iq}$.

\textit{Mean field approximation} --
We describe the temporal dynamics of the proportion of patches occupied, $p_k$ ($= N^{-1} \sum_i \pi_{ik}$), as the spatial mean field approximation of Equation \ref{eq:dm0}, dropping subscript $i$:

\begin{equation}
    \frac{dp_k}{dt} = r_{k} c_{0, k} p_{k} (1 - p_{k}) - \mu_{k} p_{k},
    \label{eq:master}
\end{equation}

where

\begin{equation}
    r_{k} = 
    \begin{cases}
        r_0 & \text{for producers,}\\
        \frac{\sum_{q~\in~\text{prey}} p_{q}}{S_{p,k}} & \text{for consumers,}
    \end{cases}
\end{equation}

and

\begin{equation}
    \mu_{k} = 
        \mu_{k}^{(0)} (1 + \rho \hat{u}) + 
        \mu_{k}^{(p)} \left(1 - \frac{\sum_{q~\in~\text{prey}} p_{q}}{S_{p, k}} \right) + 
        \mu_{k}^{(c)} \sum_{q~\in~\text{predator}} p_{q}.
    \label{eq:extn}    
\end{equation}

The parameter $c_{0, k}$ is defined in Equations \ref{eq:c0-prod}. 
In Equation \ref{eq:extn}, we introduce the expected value of the upstream river length $\hat{u}$, which can be expressed as a function of total river length $L$ and branching rate $\lambda_b$ (see Section \ref{updist} for derivation).

\subsubsection{Derivation of Expected Upstream River Length} \label{updist}

\textbf{Definitions and assumptions.}
We derive the expected value of the upstream river length, $\mathbb{E}(u)$, at a given habitat patch within a branching network characterized by total river length $L$ and branching rate $\lambda_b$.

We use the following key terms: \textit{link} and \textit{magnitude}.
The term link refers to a river segment from one confluence to another or to a terminal point of the river (i.e., the upstream origin or the river mouth).
The term magnitude refers to the number of exterior source links (links containing upstream terminals) flowing into a given link within the network.
The magnitude is one at an exterior source link.
Table \ref{tab:key-symbol} lists the key mathematical symbols used in this section.

We assume that the length of individual link $s$, denoted as $l_s$, follows an exponential distribution $l_s \sim \mbox{Exp}(\lambda_b)$ with the constraint $\sum_s l_s = L$.
The length $l_s$ can be interpreted as the ``waiting time'' to a branching event (or termination events for upstream sources).
According to statistical theory, the number of such events within a given duration follows a Poisson distribution.
In our case, this translates into counting the number of branching events $Z$ within the ``time'' frame $L$, excluding the final branching event (since link termination occurs at $L$ regardless).
Thus, $Z \sim \mbox{Pois}(\lambda_b L)$.
The total number of links $B$ equals $Z + 1$, where adding one accounts for the final event of link termination at length $L$.
We use these assumptions in the following derivation.

\begin{table}
    \centering
    \caption{Key symbols for the derivation of expected upstream river length}
    \begin{tabularx}{\textwidth}{ll}
        Symbol & Description\\
        \hline
        $u$ & upstream river length at a given habitat patch.\\
        $L$ & Total river length.\\
        $\lambda_b$ & Branching rate defining the length distribution of individual links.\\
        $l$ & Individual link length. Assumed to follow $l \sim \mbox{Exp}(\lambda_b)$.\\
        $B$ & Number of links ($B = Z + 1$).\\
        $Z$ & Number of links minus one ($Z = B - 1$).\\
        \hline
    \end{tabularx}
    \label{tab:key-symbol}
\end{table}


\textbf{Proposition}.
The expected upstream river length $\mathbb{E}(u)$ at a given habitat patch within a random branching network, characterized by total river length $L$ and branching rate $\lambda_b$, can be expressed as a function of $L$ and $\lambda_b$.

\textit{Proof.}
The expected upstream river length, $\mathbb{E}(u)$, can be decomposed as $\mathbb{E}(u) = \mathbb{E}(u') + \mathbb{E}(l')$, where $u'$ is the summed length of upstream links (excluding the link containing the habitat patch) and $l'$ is the distance from the upstream link end to the habitat patch within the focal link.
To calculate $\mathbb{E}(u')$ and $\mathbb{E}(l')$, we condition on the number of branching events as $Z = z$ ($z \in 2\mathbb{Z}_{\ge 0}$) and the number of links as $B = b = z + 1$, whose randomness is accounted for as the final step of the proof.
We clarify this conditional assumption by denoting $\cdot ~|~ z$ in the equations.
% In the following, we first derive the expected values of $u'$ and $l'$ when the random variables $Z$ and $B$ are given as $Z = z$ ($z \in \{\text{even integer}\}$, $z \ge 0$) and $B = b = z + 1$ ($b \in \{\text{odd integer}\}$, $b \ge 1$).
% We clarify this conditional assumption by denoting $\cdot ~|~ z$ in the equations.
% We account for the randomness of $Z$ as the final step of the derivation.

The summed length of upstream links $u'$ is the product of the mean length of upstream links $\hat{l}$ and the number of upstream links $n$.
% If $\lambda_b L \rightarrow \infty$ and each link length follows the \textit{i.i.d.} assumption, the expected value of mean length $\hat{l}$ ($= \sum_s^n l_s n^{-1}$) can be approximated as $\lambda_b^{-1}$ (the expected value of an exponential distribution) since one may ignore the length constraint imposed by the condition $\sum_s l_s = L$.
% If $\lambda_b L$ is not sufficiently large, however, we need to account for this constraint.
With the known sum $\sum_s l_s = L$, the fraction of single link length $F_s$ (= $l_s L^{-1}$) follows a Beta distribution as $F_s ~|~ z \sim \mbox{Beta}(1, z)$ (\textbf{Lemma 1}), whose expected value is $\mathbb{E}(F~|~z) = (z + 1)^{-1}$.
Thus, we obtain an intuitive solution for the expectation of mean length as

\begin{align}
    \begin{split}
    \mathbb{E}(\hat{l}~|~z) &= L \cdot \mathbb{E}(F~|~z)\\
                            &= L(z + 1)^{-1}\\
                            &= Lb^{-1}.
    \end{split}
\end{align}

In the limit of $\lambda_b L \rightarrow \infty$, the expected value of this quantity, $\mathbb{E}(LB^{-1})$, approaches $\lambda_b^{-1}$ since $\mathbb{E}(B) = \lambda_b L + 1$.

The number of upstream links $n$ requires the consideration of its probability distribution since $n$ depends on the location in a network.
Here, our approach leverages the known properties of Shreve's topologically distinct channel networks (TDCNs), a classical framework of bifurcating river networks.
The probability of drawing a link with magnitude $m$ at random from a population of $M$-magnitude TDCNs, $\omega(m; M)$, is described as

\begin{equation}
    \omega(m; M) = \frac{1}{2m - 1} \binom{2m}{m} \binom{2(M - m)}{M - m} \binom{2M}{M}^{-1}.
\end{equation}

The notation $\binom{\cdot}{\cdot}$ and $\binom{\cdot}{\cdot}^{-1}$ denote a binomial coefficient and its inverse.
The number of upstream links $n$ has a linear relationship with link magnitude $m$ as $n = 2m - 2$ due to the bifurcating nature of TDCNs.
Using the expected value of $m$ ($\sum_{m=1}^{M} m~\omega(m; M)$; \textbf{Lemma 2}), we obtain

\begin{align}
    \begin{split}
    \mathbb{E}(n~|~z) 
        &= \sum_{m=1}^{M} (2m - 2) \omega(m; M)\\
        &= 2 \sum_{m=1}^{M} m~\omega(m; M) - 2\\
        &= 2 \cdot 4^{M-1} \binom{2M-1}{M}^{-1} - 2\\
        &= 2^{2M-1} \binom{2M-1}{M}^{-1} - 2.
    \end{split}
    \label{eq:n-hat}
\end{align}

Here, $M$ is a function of $z$.
TDCNs satisfy the relationship $b = 2M - 1$ because two source links must join to form a single downstream link.
Using $M = (b + 1) / 2 = (z + 2) / 2$, the expected value $\mathbb{E}(n~|~z)$ can be rewritten as a function of $z$:

\begin{equation}
    \mathbb{E}(n~|~z) = \hat{n}(z) = 
    2^{z + 1} \binom{z + 1}{\frac{z + 2}{2}}^{-1} - 2.
\end{equation}

In sum, we obtain $\mathbb{E}(u' ~|~ z)$ as

\begin{align}
    \begin{split}
        \mathbb{E}(u' ~|~ z) &= \mathbb{E}(\hat{l}n ~|~ z)\\
                           &= \mathbb{E}(\hat{l} ~|~ z) \cdot \mathbb{E}(n ~|~ z)\\
                           &= \frac{L \hat{n}(z)}{z + 1}.
    \end{split}
\end{align}

We used $\mathbb{E}(\hat{l}n ~|~ z) = \mathbb{E}(\hat{l} ~|~ z) \cdot \mathbb{E}(n ~|~ z)$ in light of the lack of covariance between $\hat{l}$ and $n$.

The expected distance $\mathbb{E}(l'~|~z)$ is calculated as follows.
Assuming that habitat patches are randomly distributed along the river (i.e., Poisson process), the distance to habitat patch $i$ in link $s$, $l'_{s(i)}$, follows a uniform distribution as $l'_{s(i)}~|~z \sim \mbox{Unif}(0, l_s)$.
Thus, the conditional expectation is

\begin{equation}
    \mathbb{E}(l'_{s}~|~z) = \frac{l_s}{2}.
\end{equation}

Since the expected length of link $s$ is $\mathbb{E}(l_s~|~z) = L(z+1)^{-1}$, we obtain

\begin{align}
    \mathbb{E}(l'~|~z) = \frac{L}{2(z + 1)}.
\end{align}

Summing $\mathbb{E}(u' ~|~ z)$ and $\mathbb{E}(l'~|~z)$ for a network with a given value of $z$ yields

\begin{align}
    \begin{split}
        \mathbb{E}(u ~|~ z) 
        &= \mathbb{E}(u' ~|~ z) + \mathbb{E}(l'~|~z)\\
        &= \frac{L}{z+1} \left[ \hat{n}(z) + \frac{1}{2} \right].
    \end{split}
    \label{eq:cu}
\end{align}

Lastly, we account for the probabilistic nature of the random variable $Z$ by summing $z$ out from Equation \ref{eq:cu}.
In a bifurcating network, $Z$ must be even so that the total number of links $B$ is odd.
As such, we must consider a truncated Poisson distribution for $Z$ with zero probabilities for odd integers, denoted as $f'_{\text{pois}}(z; L, \lambda_b)$:

\begin{align}
    \begin{split}
    f'_{\text{pois}}(z; L, \lambda_b) 
    &= \frac{f_{\text{pois}}(z; L, \lambda_b)}{\Pr(Z \in 2\mathbb{Z}_{\ge 0})} \cdot \frac{1 + (-1)^{z}}{2}\\
    &= f_{\text{pois}}(z; L, \lambda_b) \cdot \frac{1 + (-1)^{z}}{1 + e^{-2\lambda_b L}},
    \end{split}
    \label{eq:tpois}
\end{align}

where $f_{\text{pois}}(z; L, \lambda_b)$ is the probability mass function of a Poisson distribution defined as

\begin{equation}
    f_{\text{pois}}(z; L, \lambda_b) = \Pr(Z = z) = \frac{(\lambda_b L)^{z} e^{-\lambda_b L}}{z!},
\end{equation}

and $\Pr(Z \in 2\mathbb{Z}_{\ge 0}) = 2^{-1}(1 + e^{- 2 \lambda_b L})$ (\textbf{Lemma 3}). 
% In Equation \ref{eq:tpois}, $f_{\text{pois}}(z; L, \lambda_b)$ is divided by the probability of $Z$ taking even integers $\Pr(Z = \text{even})$ so that $\sum_{z=0}^{\infty} f'_{\text{pois}}(z; L, \lambda_b) = 1$.
Following the definition of expected value, we obtain $\mathbb{E}(u)$ as a function of $L$ and $\lambda_b$:

\begin{align}
    \begin{split}
        \mathbb{E}(u) = \hat{u}(L, \lambda_b) 
                    &= \sum_{z \in \mathbb{Z}_{\ge 0}} \left[ \frac{L}{z + 1} \left(\hat{n}(z) + \frac{1}{2}\right) f'_{\text{pois}}(z; L, \lambda_b) \right]\\
                    &= L \sum_{z \in \mathbb{Z}_{\ge 0}} \left[ \frac{\hat{n}(z)}{z + 1} f'_{\text{pois}}(z; L, \lambda_b)\right] + 
                    \frac{1 - e^{-2 \lambda_b L}}{2 \lambda_b (1 + e^{-2 \lambda_b L})}.
    \end{split}
\end{align}

\subsubsection{Proofs of Lemma}

\textbf{Lemma 1.}
Let $X_1$ and $X_2$ be independent random variables that follow Gamma distributions as $X_1 \sim \mbox{Ga}(\alpha, \lambda)$ and $X_2 \sim \mbox{Ga}(\beta, \lambda)$.
Then, the conditional distribution of $F = X_1(X_1 + X_2)^{-1}$ given $X_1 + X_2 = y$ follows $\mbox{Beta}(\alpha, \beta)$.

\textit{Proof}.
Let $Y = X_1 + X_2$, then the conditional probability density of $X_1$, $f_{X_1}(x_1 | Y = y)$ (0 $\le x_1 \le y$), is defined as

\begin{equation}
    f_{X_1}(x_1~|~Y = y) = \frac{f_{X_1}(x_1) f_{X_2}(y - x_1)}{f_{Y}(Y = y)}
\end{equation}

Given the reproductive property of Gamma distribution, $Y$ follows a Gamma distribution as $Y \sim \mbox{Ga}(\alpha + \beta, \lambda)$.
Thus, we get

\begin{align}
    \begin{split}
        f_{X_1}(x_1~|~Y = y)
        &= 
        \left[
            \frac{\lambda^{\alpha + \beta}}{\Gamma(\alpha) \Gamma(\beta)}x_1^{\alpha - 1} (y - x_1)^{\beta - 1} e^{-\lambda y}
        \right]
        \left[
            \frac{\lambda^{\alpha + \beta}}{\Gamma(\alpha + \beta)} y^{\alpha + \beta - 1} e^{-\lambda y}
        \right]^{-1}\\
        &= \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha) \Gamma(\beta) y^{\alpha + \beta - 1}} x_1^{\alpha - 1} (y - x_1)^{\beta - 1}\\
        &= \frac{x_1^{\alpha - 1} (y - x_1)^{\beta - 1}}{\mbox{B}(\alpha, \beta) y^{\alpha + \beta - 1}},
    \end{split}
    \label{eq:dbeta}
\end{align}

where $\mbox{B}(\cdot, \cdot)$ denotes a beta function.
The conditional probability density function $f(x_1 | Y = 1)$ represents the probability density function of $\mbox{Beta}(\alpha, \beta)$.
Thus, we obtain

\begin{equation}
    F \sim \mbox{Beta}(\alpha, \beta).
\end{equation}

\textbf{Lemma 2.}
Let $\omega(m; M)$ be a probability mass function defined as

\begin{equation}
    \omega(m; M) = \frac{1}{2m - 1} \binom{2m}{m} \binom{2(M - m)}{M - m} \binom{2M}{M}^{-1}.
\end{equation}

Then, the expected value of $m$ is given by

\begin{equation}
    \mathbb{E}(m; M) = \sum_{m = 1}^M m~\omega(m; M) = 4^{M-1} \binom{2M-1}{M}^{-1}.
\end{equation}

\textit{Proof.}  
We begin by reorganizing the probability mass function

\begin{equation}
    \omega(m; M) = \frac{(2M - 2m - 1) M}{(M - m)(2M - 1)} \omega(m; M - 1).
\end{equation}

From this, we can express

\begin{equation}
    (M - m) \omega(m; M) = \frac{(2M - 2m - 1) M}{2M - 1} \omega(m; M - 1).
\end{equation}

Summing over all $m$, we get

\begin{equation}
    \sum_{m = 1}^{M - 1} (M - m) \omega(m; M)
    = \sum_{m = 1}^{M} (M - m) \omega(m; M)
    = \frac{M}{2M - 1} \sum_{m = 1}^{M - 1} (2M - 2m - 1) \omega(m; M - 1).
\end{equation}

Using the fact that $\sum_{m = 1}^{M} \omega(m; M) = 1$, the equation above leads to the following recurrence relation for the expected value:

\begin{equation}
    \mathbb{E}(m; M) = \frac{2M}{2M - 1} \mathbb{E}(m; M - 1).
\end{equation}

Considering $\mathbb{E}(m; M = 1) = 1$, we can recursively calculate the expected value:

\begin{equation}
    \mathbb{E}(m; M) = \frac{2M}{2M - 1} \cdot \frac{2M - 2}{2M - 3} \cdot \ldots \cdot \frac{4}{3} \cdot \mathbb{E}(m; 1) = 4^{M - 1} \frac{M!(M - 1)!}{(2M - 1)!}.
\end{equation}

Thus, we conclude

\begin{equation}
    \mathbb{E}(m; M) = 4^{M - 1} \binom{2M - 1}{M}^{-1}.
\end{equation}

Yutaka Osada and Ryosuke Iritani contributed this Lemma.

\textbf{Lemma 3.} Let $f_{\text{pois}}(y; \lambda) = \Pr(Y = y)$ be the probability mass function of a Poisson distribution.
Then, $\Pr(Y \in 2\mathbb{Z}_{\ge 0}) = 2^{-1}(1 + e^{- 2 \lambda})$.

\textit{Proof}.

\begin{align}
    \begin{split}
        \Pr(Y \in 2\mathbb{Z}_{\ge 0}) 
        &= \sum_{z = 0}^{\infty} \left[ \frac{\lambda^{y} e^{-\lambda}}{y!} \cdot \frac{1 + (-1)^{y}}{2} \right]\\
        &= \frac{e^{-\lambda}}{2} \left[ \sum_{y = 0}^{\infty} \frac{\lambda^{y}}{y!} + \sum_{y = 0}^{\infty} \frac{(-\lambda)^{y}}{y!}\right]\\
        &= \frac{e^{-\lambda}}{2} (e^{\lambda} + e^{-\lambda})\\
        &= \frac{1 + e^{- 2 \lambda}}{2}.
    \end{split}
\end{align}

\newpage

\subsection{Empirical Analysis}

\subsubsection{Discharge-Precipitation Relationship}
We used daily river discharge data from 2000 to 2015, simulated by the Global Hydrodynamics model \textit{CaMa-Flood}, to estimate flow variability.
The discharge data is available at a 0.1-degree resolution (approximately 10 km at the equator) and was extracted from the nearest flow-connected cell for each site; however, discharge data could not be obtained for two headwater stream sites, which were excluded from further analysis.
At each site, we log-transformed the discharge data and scaled it by the temporal mean to facilitate comparison across sites with varying stream sizes.

We define ``flow variability'' as the magnitude of discharge deviations from seasonal expectations.
To model this variability, we fitted a Generalized Additive Model (GAM) as follows:

\begin{align}
    \begin{split}
    D_i &= \alpha_d + s(\text{Julian}_i) + \varepsilon_i,\\
    \varepsilon_i &\sim t(0, \sigma_d^2, \nu_d),
    \end{split}
\end{align}

where $D_i$ represents the scaled daily discharge, "Julian" refers to the Julian date (with the first day of the year as the origin), and $s(\cdot)$ denotes the smoothing spline.
We used a Student's t-distribution for the error structure, as it better captures the fat-tailed nature of the discharge data.
The degree of freedom, $\nu_d$, characterizes the thickness of the tails, with smaller values indicating a higher likelihood of extreme high or low flows relative to seasonal expectations (i.e., fatter tails).
As $\nu_d$ approaches infinity, the Student's t-distribution converges to a normal distribution.

We regressed the log-transformed degrees of freedom ($\ln \nu_d$) on the log-transformed regional precipitation (i.e., the watershed average; see Maintext) using a linear mixed-effects model with random effects for watershed ID and hydrological region.
The model revealed a significant negative scaling relationship, described by the equation $\ln \nu_d = 16.84 - 2.02 \cdot \ln \text{precipitation} + \text{error}$ (SE for intercept: 4.01, SE for slope: 0.57).
This result suggests that watersheds with higher precipitation are more likely to experience extreme high or low flows relative to seasonal norms.\ref{fig:sim-main}

\input{rmd/figure_si}

\end{document}